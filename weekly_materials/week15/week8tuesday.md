# Week 15 Exercise: PHP Email Form (9 May 2017)

## Overview & Goals
In today's exercise, you'll build a simple PHP contact form. Because it's easy for a form like this to be abused, rather than writing our own script, we're going to use one that's been developed to include some security features. 

## Downloading and Editing the Script

We're going to use a PHP script provided by a company called Tectite. Got to 
https://www.tectite.com/formmailpage.php , and click the "Download Now" button to download the formmail.zip file. Unzip archive, and put the formmail.php and sampleform.html files in your week15 directory. 

Open the formmail.php file in Visual Studio Code; you'll see that there is a good bit of documentation in the file itself. Under the "Quick Start" information, it tells you that the only thing you absolutely have to change in the script is changing the TARGET_EMAIL to the domain to which the mail script can send email (in this case, rit.edu). 

Scroll down to the CONFIGURATION section of the file (it begins at line 426). Edit the $TARGET_EMAIL line to this:

`$TARGET_EMAIL = array($EMAIL_NAME . "@rit\.edu$");`

That's all you need to do! (Make sure you save the changes to the file.)

## Creating the Form
Back in week 8b, you created a simple contact form and styled with CSS. You're going to use that form now as your starting point. Copy the index.html and form.css files from your week8b folder into your week15 folder.

Now you're going to make the following changes to the index.html file:

1. Edit the form tag at the beginning of your form to use the URL to formmail.php on your website in the 'action' value. add the necessary hidden input field below it.
```html
  <form method="post" action="https://people.rit.edu/youruserid/igme230/week15/formmail.php" name="ContactForm">
```

2. Add the following hidden input field below the form tag:
```html
  <input type="hidden" name="env_report" value="REMOTE_HOST,REMOTE_ADDR,HTTP_USER_AGENT,AUTH_TYPE,REMOTE_USER" />
```

3. Add a hidden 'recipients' input field with your email address as the value. (Since you limited emails to the rit.edu domain when you configured the script, you'll need to use your RIT address for this--*make sure you change "youruserid" to your actual user id!*)
 ```html
  <input type="hidden" name="recipients" value="youruserid@rit.edu" />
```

4. Add a hidden 'required' input field to specify that the EMailAddr and FullName fields must be filled in. (NOTE: DO NOT put your email address and name here. "Your email address" and "Your name" are error messages for your users to see, not placeholders for you to replace.)

```html
  <input type="hidden" name="required" value="EmailAddr:Your email address,FullName:Your name" />
```

5. Add a hidden 'subject' input field with the subject line you want the messages generated by the form to include.

```html
  <input type="hidden" name="subject" value="Test Mail from Contact Form" />
```

6. In your original form, make the following changes:
  - `<input type="text" id="name" name="username">` to `<input type="text" id="name" name="FullName">`
  - `<input type="email" id="mail" name="usermail">` to `<input type="email" id="mail" name="EmailAddr">`
  - `<textarea name="comments">` to `<textarea name="mesg">`

7. You don't really want people to send passwords, so remove the `<div>` containing the password field. 


## Test the Form
Upload the week15 folder, with the formmail.php, index.html, and form.css files, to your igme230 folder on banjo. (Make sure you've set the permissions properly on the directory and the files.)

Load the index.html file in a browser, fill out the form, and click the submit button. If everything worked, you should see the following results page:

```
Thanks! We've received your information and, if it's appropriate, we'll be in contact with you soon.
Your form submission was processed by FormMail (9.14), a PHP script available from www.tectite.com.
```

You should also receive an email message that appears to be from you, with the contents of the form in the message. 


## Submitting Your Work
This is an optional exercise, so there's no specific due date. I suggest that once you've got the form working, you add a link to your week15 directory from your main igme230 page--but that's so that you can find it easily later.  











